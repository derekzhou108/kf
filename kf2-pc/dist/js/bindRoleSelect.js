"use strict";var bindRoleSelectVm=avalon.define({$id:"bindRoleSelect",list:[],icon:"",item:"",selected:function(e,t){var i=this;this.list.forEach(function(r,n,o){e===n?(o[n].selected=1,i.item=t):o[n].selected=0})},bindRole:function(){var e=this;if(!this.item)return dialog.errorMsg("请选择未绑定的游戏角色"),!1;var t=util.getQueryString("appId"),i=util.getQueryString("system"),r=util.getStorage("userInfo").user_id,n=util.getStorage("userInfo").token;api.check({loginAppId:t,sdkUserId:r,token:n}).then(function(n){var o={appId:t,platform:i,serverId:e.item.serverId,roleId:e.item.roleId,roleType:e.item.roleType,roleName:e.item.roleName,sdkUserId:r};api.sdkBindRole(o).then(function(e){dialog.successMsg("绑定成功！"),setTimeout(function(){util.reload()},2e3)})})}});bindRoleSelectVm.$watch("onReady",function(){var e=this,t=util.getQueryString("appId"),i=util.getQueryString("system"),r=util.getStorage("userInfo");api.serverList({appId:t}).then(function(t){e.icon=t.data.app.icon}),t&&r&&api.sdkGameRoles({appId:t,sdkUserId:r.user_id,platform:i}).then(function(t){1e4===t.code?e.list=t.data.map(function(e){return e.selected=0,e}):dialog.errorMsg(t.msg)})});